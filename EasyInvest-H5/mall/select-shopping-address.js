define(["butterfly/view","butterfly","mall/mall-client","dialog","../shared/js/loading","iscroll"],function(a,b,c,d,e,f){return a.extend({events:{"click .go-back":"goBack","click .addressLi":"selectAddress","click #manageAddress":"manageAddress"},addressManagementData:[],render:function(){this.loading=new e({parentEl:this.$(".container")[0]})},onShow:function(a){this.getAddressManagementData()},manageAddress:function(){butterfly.navigate("account/shipping-address-management.html",{isPopupView:!0})},selectAddress:function(a){var b=$(a.currentTarget).attr("data-value"),c=JSON.parse(b);butterfly.back(-1,{addressData:c})},getAddressManagementData:function(){var a=this,b=$("<div class = 'msg-notice notData'>您还没有添加收货地址</div>");c.ajax({url:c.ADDRESS_GET_URL,beforeSend:function(){a.loading&&a.loading.show()},success:function(c){0==c.result?c.data.length>0?(a.$("#addressManagementContent").html(""),a.addressManagementData=c.data,a.initAddressManagementView()):a.$("#addressManagementContent").append(b):1007==c.result?a.$("#addressManagementContent").append(b):d.showToast(c.error)},error:function(a,b){d.showToast("数据获取失败,请检查网络")},complete:function(){a.loading&&a.loading.hide()}})},initAddressManagementView:function(){var a=this,b=a.$("#addressManagementContent");a.$("#addressManagementContent").html("");for(var c=0,d=a.addressManagementData.length;d>c;c++){var e=_.template(a.$("#addressManagement_template").html(),a.addressManagementData[c]);b.append(e)}a.setDefaultStyle()},setDefaultStyle:function(){var a=this,b=$(a.$("#addressManagementContent >li")[0]);b.find(".address_iconBox").addClass("check"),b.find(".address_icon").show(),b.find(".defaultAddress").show(),b.find(".address_iconBox").attr("style","border:0px;")}})});