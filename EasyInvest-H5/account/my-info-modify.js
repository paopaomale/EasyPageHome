define(["butterfly/view","butterfly","dialog","../account/account-client","../shared/js/loading","moment"],function(a,b,c,d,e){return a.extend({myInfoData:{},events:{"click .go-back":"goBack","click #onModifyMyInfo":"onModifyMyInfo","click .select-sex":"onSelctSex","click #modifyAddress":"onModifyAddress"},render:function(){this.initLoading(),this.initDate()},onShow:function(){},onModifyAddress:function(a){var b=$(a.currentTarget).attr("addressdata");butterfly.navigate("account/create-address.html",{type:"editAddress",data:b,isPopupView:!0})},initLoading:function(){this.loading=new e({parentEl:this.$(".container")[0]})},getName:function(){var a=this,b=a.$("#userName").val().trim();return""==b?void c.showToast("昵称不能为空!"):void(a.myInfoData.name=b)},getBirthday:function(){var a=this,b=a.$el.find("#birthdayInput").val();b&&(a.myInfoData.birthday=b)},initDate:function(){var a=this,b={theme:"ios",dateFormat:"yy-mm-dd",display:"bottom",maxDate:new Date((new Date).getFullYear()+10,11,30),lang:"zh",mode:"mixed",context:a.$el,onSelect:function(b){a.isDate(b)}};a.myInfoData&&a.myInfoData.birthday?b.defaultValue=new Date(a.myInfoData.birthday):b.defaultValue=new Date,a.$el.find("#birthdayInput").val(moment(b.defaultValue).format("YYYY-MM-DD")),a.$el.find("#birthdayInput").mobiscroll().date(b)},isDate:function(a){var b=this,d=moment(),e=moment(a);return e>d?void c.showToast("生日不能大于当前时间!"):(b.$el.find(".time").text(a),void(b.myInfoData.birthday=a))},onSelctSex:function(a){var b=$(a.currentTarget);b.find("i").hasClass("icon-checked-fill")?(b.parent().find("i").removeClass("icon-checked-fill"),b.find("i").addClass("icon-radio-unchecked")):(b.parent().find("i").removeClass("icon-checked-fill"),b.find("i").addClass("icon-checked-fill"))},onModifyMyInfo:function(a){var b=this,e=moment(),f=b.$("#userName").val().trim(),g=b.$(".icon-checked-fill").attr("data-value"),h=b.$el.find("#birthdayInput").val(),i=moment(h);if(""==f)return c.showToast("昵称不能为空!"),!1;if(i>e)return void c.showToast("生日不能大于当前时间!");var j={name:f,sex:g,birthday:h,imgId:"imgId"};d.modifyInfo({data:j,beforeSend:function(){b.loading&&b.loading.show()},success:function(a){},complete:function(){b.loading&&b.loading.hide()}})}})});