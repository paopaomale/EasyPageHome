define(["zepto"],function(a){!function(a){function b(a){return"tagName"in a?a:a.parentNode}function c(a,b,c,d){var e=Math.abs(a-b),f=Math.abs(c-d);return e>=f?a-b>0?"Left":"Right":c-d>0?"Up":"Down"}function d(){j=null,k.last&&(k.el.trigger("longTap"),k={})}function e(){j&&clearTimeout(j),j=null}function f(){g&&clearTimeout(g),h&&clearTimeout(h),i&&clearTimeout(i),j&&clearTimeout(j),g=h=i=j=null,k={}}var g,h,i,j,k={},l=750;a(document).ready(function(){var m,n;a(document.body).bind("touchstart",function(c){m=Date.now(),n=m-(k.last||m),k.el=a(b(c.touches[0].target)),g&&clearTimeout(g),k.x1=c.touches[0].pageX,k.y1=c.touches[0].pageY,n>0&&250>=n&&(k.isDoubleTap=!0),k.last=m,j=setTimeout(d,l)}).bind("touchmove",function(a){e(),k.x2=a.touches[0].pageX,k.y2=a.touches[0].pageY,Math.abs(k.x1-k.x2)>10&&a.preventDefault()}).bind("touchend",function(b){e(),k.x2&&Math.abs(k.x1-k.x2)>30||k.y2&&Math.abs(k.y1-k.y2)>30?i=setTimeout(function(){k.el.trigger("swipe"),k.el.trigger("swipe"+c(k.x1,k.x2,k.y1,k.y2)),k={}},0):"last"in k&&(h=setTimeout(function(){var b=a.Event("tap");b.cancelTouch=f,k.el.trigger(b),k.isDoubleTap?(k.el.trigger("doubleTap"),k={}):g=setTimeout(function(){g=null,k.el.trigger("singleTap"),k={}},250)},0))}).bind("touchcancel",f),a(window).bind("scroll",f)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}})}(Zepto),function(a){a.extend(a,{contains:function(a,b){return a.compareDocumentPosition?!!(16&a.compareDocumentPosition(b)):a!==b&&a.contains(b)}})}(Zepto),function(a,b){a.extend(a,{toString:function(a){return Object.prototype.toString.call(a)},slice:function(a,b){return Array.prototype.slice.call(a,b||0)},later:function(a,b,c,d,e){return window["set"+(c?"Interval":"Timeout")](function(){a.apply(d,e)},b||0)},parseTpl:function(a,b){var c="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",d=new Function("obj",c);return b?d(b):d},throttle:function(c,d,e){function f(){function a(){h=Date.now(),d.apply(i,k)}function f(){g=b}var i=this,j=Date.now()-h,k=arguments;e&&!g&&a(),g&&clearTimeout(g),e===b&&j>c?a():g=setTimeout(e?f:a,e===b?c-j:c)}var g,h=0;return"function"!=typeof d&&(e=d,d=c,c=250),f._zid=d._zid=d._zid||a.proxy(d)._zid,f},debounce:function(c,d,e){return d===b?a.throttle(250,c,!1):a.throttle(c,d,e===b?!1:e!==!1)}}),a.each("String Boolean RegExp Number Date Object Null Undefined".split(" "),function(d,e){var f;if(!("is"+e in a)){switch(e){case"Null":f=function(a){return null===a};break;case"Undefined":f=function(a){return a===b};break;default:f=function(a){return new RegExp(e+"]","i").test(c(a))}}a["is"+e]=f}});var c=a.toString}(Zepto),function(a,b){var c=navigator.userAgent,d=navigator.appVersion,e=a.browser;a.extend(e,{qq:/qq/i.test(c),uc:/UC/i.test(c)||/UC/i.test(d)}),e.uc=e.uc||!e.qq&&!e.chrome&&!e.firefox&&!/safari/i.test(c);try{e.version=e.uc?d.match(/UC(?:Browser)?\/([\d.]+)/)[1]:e.qq?c.match(/MQQBrowser\/([\d.]+)/)[1]:e.version}catch(f){}a.support=a.extend(a.support||{},{orientation:!(e.uc||parseFloat(a.os.version)<5&&(e.qq||e.chrome))&&!(a.os.android&&parseFloat(a.os.version)>3)&&"orientation"in window&&"onorientationchange"in window,touch:"ontouchend"in document,cssTransitions:"WebKitTransitionEvent"in window,has3d:"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix})}(Zepto),function(a){function b(){a(window).on("scroll",a.debounce(80,function(){a(document).trigger("scrollStop")},!1))}function c(){a(window).off("scroll"),b()}a.matchMedia=function(){var b=0,c="gmu-media-detect",d=a.fx.transitionEnd,e=a.fx.cssPrefix,f=a("<style></style>").append("."+c+"{"+e+"transition: width 0.001ms; width: 0; position: absolute; top: -10000px;}\n").appendTo("head");return function(e){var g,h=c+b++,i=a('<div class="'+c+'" id="'+h+'"></div>').appendTo("body"),j=[];return f.append("@media "+e+" { #"+h+" { width: 1px; } }\n"),"matchMedia"in window?window.matchMedia(e):(i.on(d,function(){g.matches=1===i.width(),a.each(j,function(b,c){a.isFunction(c)&&c.call(g,g)})}),g={matches:1===i.width(),media:e,addListener:function(a){return j.push(a),this},removeListener:function(a){var b=j.indexOf(a);return~b&&j.splice(b,1),this}})}}(),a(function(){var b=function(b){a(window).trigger("ortchange")};a.mediaQuery={ortchange:"screen and (width: "+window.innerWidth+"px)"},a.matchMedia(a.mediaQuery.ortchange).addListener(b)}),b(),a(window).on("pageshow",function(b){b.persisted&&a(document).off("touchstart",c).one("touchstart",c)})}(Zepto),function(a){var b,c,d,e=!1,f=function(){clearTimeout(c),b&&(d=b.attr("highlight-cls"))&&(b.removeClass(d).attr("highlight-cls",""),b=null)};a.extend(a.fn,{highlight:function(d){return e=e||!!a(document).on("touchend.highlight touchmove.highlight touchcancel.highlight",f),f(),this.each(function(){var e=a(this);e.css("-webkit-tap-highlight-color","rgba(255,255,255,0)").off("touchstart.highlight"),d&&e.on("touchstart.highlight",function(){c=a.later(function(){b=e.attr("highlight-cls",d).addClass(d)},100)})})}})}(Zepto)});