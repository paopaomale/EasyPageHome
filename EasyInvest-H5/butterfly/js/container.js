define(["butterfly","butterfly/view"],function(a,b){return b.extend({initialize:function(a){b.prototype.initialize.call(this,a),this.routes={};var c=this.el.getAttribute("data-routes");c&&_.chain(c.replace(/[\n\t\s]/g,"").split(",")).map(function(a){return a.split(":")}).foldl(function(a,b){return a[b[0]]=b[1],a},this.routes)},addSubview:function(a){b.prototype.addSubview.call(this,a);var c=a.el.getAttribute("data-route")||a.el.id;c&&(this.routes[c]=a)},setContentView:function(b){var c=this;a.ViewLoader.loadView(b,function(a){c.contentView&&(c.contentView.hide(),c.contentView.remove()),c.contentView=a,c.el.appendChild(a.el),a.show()})},route:function(a,b){if(a){var c=a.split("/"),d=c.shift(),e=this.routes[d];e&&(this.contentView=e,this.subviews.forEach(function(a){a.el.classList.remove("active"),a.hide()}),e.el.classList.add("active"),e.show(),c.length>0&&e.route(c.join("/")))}}})});