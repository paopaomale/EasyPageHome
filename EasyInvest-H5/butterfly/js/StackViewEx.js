define(["butterfly/StackView"],function(a){return a.extend({route:function(b,c){var d=0,e=this.checkBackLevel();if(e>0)for(var f=this.stack.length-e-1;f>=0;f--,d++){var g=this.stack[f];if(!g.options||!g.options.isPopupView)break}d>0?setTimeout(function(){window.history.go(-d,c)},0):a.prototype.route.apply(this,arguments)}})});