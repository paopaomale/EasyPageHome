define(["butterfly/view","butterfly","shared/js/datasource","listview/ListView","swipe","iscroll","main/main-client","shared/js/mobiscroll/mobiscroll-concat"],function(a,b,c,d,e,f,g){return a.extend({events:{"click .contentWarp":"selectItem","click .messageWarp":"selectItem"},render:function(){this.getMessage()},onShow:function(){this.initAdSwipe(),this.initListview()},getMessage:function(){var a=this;g.ajax({url:g.MESSAGE_GET_URL,beforeSend:function(){},success:function(b){b&&0===b.result&&b.data&&b.data[0]&&(a.$(".messageWarpText").html(b.data[0].title),a.UIShowMessage())},error:function(a){},complete:function(){}})},UIShowMessage:function(){var a=this;a.$(".messageWarp").show(),a.$(".contentBody").addClass("hasMessage"),a.listview&&a.listview.IScroll&&a.listview.IScroll.refresh()},initListview:function(){var a=this;if(this.listview)this.listview.IScroll&&this.listview.IScroll.refresh();else{var b=new c({storage:"none",identifier:"investDatasource",url:g.INFO_LIST_URL,requestParams:{channelId:"123"}}),e=this.$("#CBListview"),f=_.template(a.$("#listview-template").html());this.listview=new d({id:"investListview",el:e,autoLoad:!0,itemTemplate:f,dataSource:b})}},geneAdSwipeImg:function(a){for(var b='<%var img%><div class="adContent"><img width="100%" src="<%=img%>"/></div>',c="",d=a.length,e=0;d>e;e++)c+=_.template(b,a[e]);return c},initAdSwipe:function(){var a=this;a.adSwipe?a.adSwipe.setup():g.ajax({url:g.BANNER_LIST_URL,beforeSend:function(){},success:function(b){if(b&&0===b.result&&b.data){var c=a.geneAdSwipeImg(b.data);a.$(".adSwipe .swipe-wrap").html(c),setTimeout(function(){a.adSwipe=new Swipe(a.$(".adSwipe")[0],{startSlide:0,speed:3e3,auto:1e3,continuous:!0,disableScroll:!1,stopPropagation:!1,closeEndMotion:!0})},0)}},complete:function(){}})},selectItem:function(a){var b=$(a.currentTarget).attr("id");butterfly.navigate("main/main-message-detail.html",{id:b})}})});