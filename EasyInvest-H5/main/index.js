define(["butterfly/view","butterfly","json!main/moduleConfig.json","shared/js/filter-html"],function(a,b,c){return a.extend({pages:[],pageUrl:[],currentShowPage:parseInt(c.mainPage),events:{"click .tab-item":"tabClick"},render:function(){var a=this;return a.initFooter(),sessionStorage.clear(),this},onShow:function(a){a&&a.pageIndex>=0&&(this.currentShowPage=a.pageIndex),this.$("#content").height=innerHeight-this.$("footer").height,this.showPage(this.currentShowPage,a),this.swicthIcon(this.currentShowPage)},preload:function(a,b){b.preload&&this.appendPage(a,!1)},isLogin:function(){return window.localStorage.getItem("token")?!0:!1},tabClick:function(a){var b=a.target;-1===b.className.indexOf("tab-item")&&(b=this.$(b).parents(".tab-item")[0]);var c=$(b).attr("data-navigator");parseInt(c)!==this.currentShowPage&&(this.currentShowPage=parseInt(c),this.showPage(this.currentShowPage),this.swicthIcon(this.currentShowPage))},swicthIcon:function(a){this.$(".tab-item").removeClass("actived"),this.$(".tab-item").eq(a).addClass("actived")},initFooter:function(){var a=this;_.each(c.data,function(b,c){a.pageUrl.push(b.PageUrl),a.pages.push(null);var d=c;a.preload(d,b)})},appendPage:function(a,b){var c=this,d=a;require(["view!"+c.pageUrl[d]+".html"],function(a){var e=new a;c.pages[d]=e,e.render(),b&&($("#mainIndex #content").html(e.el),e.onShow())},function(a){console.error("Load View Eorror")})},showPage:function(a,b){var c=this;c.pages[a]?($("#mainIndex #content").html(c.pages[a].el),c.pages[a].delegateEvents(),c.pages[a].onShow(b)):c.appendPage(a,!0)}})});